library(tidyverse)
library(broom)
library(stringr)
library(forcats)
options(scipen = 999)
library(MASS) # For Boston data set
library(tidymodels)
library(ISLR)
lm_spec <- linear_reg() %>%
set_mode("regression") %>%
set_engine("lm")
lm_fit <- lm_spec %>%
fit(medv ~ lstat, data = Boston)
lm_fit
lm_fit %>%
pluck("fit")
library(broom)
lm_fit %>%
pluck("fit") %>%
summary()
lm_fit %>%
pluck("fit") %>%
summary()
tidy(lm_fit)
glance(lm_fit)
predict(lm_fit, new_data = Boston)
predict(lm_fit, new_data = Boston, type = "conf_int")
bind_cols(
predict(lm_fit, new_data = Boston),
Boston
) %>%
select(medv, .pred)
bind_cols(
predict(lm_fit, new_data = Boston),
Boston
)
bind_cols(
predict(lm_fit, new_data = Boston),
Boston
) %>%
dplyr::select(medv, .pred)
augment(lm_fit, new_data = Boston) %>%
dplyr::select(medv, .pred)
Boston %>% names()
library(leaps)
hitters <- na.omit(ISLR::Hitters) %>%
as_tibble
library(tidyverse)
my_function <- function(n){
tibble(
randNorm = rnorm(n),
randDensity = dnorm(randNorm)
) %>%
ggplot(aes(
x = randNorm,
y = randDensity)) +
geom_point() +
labs(
x = "Random Normal Distribution",
y = "Density")
}
my_function(30)
norm_dist_plot <- function(n){
tibble(
randNorm = rnorm(n),
randDensity = dnorm(randNorm)
) %>%
ggplot(aes(
x = randNorm,
y = randDensity)) +
geom_point() +
labs(
x = "Random Normal Distribution",
y = "Density")
}
roulette_function <- function(n, seed) {
set.seed(seed)
df <- tibble(
Rolls = seq(1:n),
Outcome = sample(c("Red", "Black"),
n, replace = TRUE,
prob = c(0.5, 0.5))
) %>%
mutate(
Streak = sequence(rle(Outcome)$lengths),
EndOfStreak = ifelse(lead(Outcome)==Outcome, "No", "Yes")
)
}
roulette_function(100)
roulette_function <- function(n, seed = 1) {
set.seed(seed)
df <- tibble(
Rolls = seq(1:n),
Outcome = sample(c("Red", "Black"),
n, replace = TRUE,
prob = c(0.5, 0.5))
) %>%
mutate(
Streak = sequence(rle(Outcome)$lengths),
EndOfStreak = ifelse(lead(Outcome)==Outcome, "No", "Yes")
)
}
roulette_function(100)
roulette_function(100)
roulette_function <- function(n, seed = 1) {
set.seed(seed)
df <- tibble(
Rolls = seq(1:n),
Outcome = sample(c("Red", "Black"),
n, replace = TRUE,
prob = c(0.5, 0.5))
) %>%
mutate(
Streak = sequence(rle(Outcome)$lengths),
EndOfStreak = ifelse(lead(Outcome)==Outcome, "No", "Yes")
)
return(df)
}
roulette_function(100)
roulette_function <- function(n, seed = 1) {
set.seed(seed)
df <- tibble(
Rolls = seq(1:n),
Outcome = sample(c("Red", "Black"),
n, replace = TRUE,
prob = c(0.5, 0.5))
) %>%
mutate(
Streak = sequence(rle(Outcome)$lengths),
EndOfStreak = ifelse(lead(Outcome)==Outcome, "No", "Yes")
)
}
df <- roulette_function(100)
roulette_function <- function(n, seed = 1) {
set.seed(seed)
tibble(
Rolls = seq(1:n),
Outcome = sample(c("Red", "Black"),
n, replace = TRUE,
prob = c(0.5, 0.5))
) %>%
mutate(
Streak = sequence(rle(Outcome)$lengths),
EndOfStreak = ifelse(lead(Outcome)==Outcome, "No", "Yes")
)
}
df1 <- roulette_function(100)
df1
roulette_dist <- function(df){
streaks <- df %>%
filter(EndOfStreak=="Yes") %>%
group_by(Streak) %>%
summarise(Times=n()) %>%
ungroup() %>%
mutate(Probability=Times/sum(Times))
}
ddf <- roulette_dist(df1)
ddf
p <- 0.025
tail_low <- seq(-4, qnorm(p), 0.01)
df_tl <- data.frame(x=c(tail_low,qnorm(p)), y =c(dnorm(tail_low),0))
tail_high <- seq(qnorm(1-p), 4, 0.01)
df_th <- data.frame(x=c(qnorm(1-p),tail_high), y=c(0,dnorm(tail_high)))
ggplot(data.frame(x = c(-4, 4)), aes(x)) +
stat_function(fun = dnorm) +
geom_polygon(data = df_tl, aes(x,y), fill = "#99CCFF") +
geom_polygon(data = df_th, aes(x,y), fill = "#99CCFF") +
geom_vline(xintercept = qnorm(p), lty = "dashed", lwd = 0.3) +
geom_vline(xintercept = qnorm(1-p), lty = "dashed", lwd = 0.3) +
annotate(geom = "text", -1.97, 0.1, label = "-1.96", hjust = "right") +
annotate(geom = "text", 1.97, 0.1, label = "1.96", hjust = "left") +
theme_classic() +
labs(x="", y="")
ci_plot <- function(p){
tail_low <- seq(-4, qnorm(p), 0.01)
df_tl <- tibble(
x = c(tail_low,qnorm(p)),
y = c(dnorm(tail_low), 0))
tail_high <- seq(qnorm(1 - p), 4, 0.01)
df_th <- tibble(
x = c(qnorm(1 - p), tail_high),
y = c(0, dnorm(tail_high)))
tibble(x = c(-4, 4)) %>%
ggplot(aes(x)) +
stat_function(fun = dnorm) +
geom_polygon(data = df_tl, aes(x, y), fill = "#99CCFF") +
geom_polygon(data = df_th, aes(x, y), fill = "#99CCFF") +
geom_vline(xintercept = qnorm(p), lty = "dashed", lwd = 0.3) +
geom_vline(xintercept = qnorm(1-p), lty = "dashed", lwd = 0.3) +
annotate(geom = "text", -1.97, 0.1, label = "-1.96", hjust = "right") +
annotate(geom = "text", 1.97, 0.1, label = "1.96", hjust = "left") +
theme_classic() +
labs(
x="",
y="")
}
ci_plot(0.025)
ci_plot <- function(p = 0.025){
tail_low <- seq(-4, qnorm(p), 0.01)
df_tl <- tibble(
x = c(tail_low,qnorm(p)),
y = c(dnorm(tail_low), 0))
tail_high <- seq(qnorm(1 - p), 4, 0.01)
df_th <- tibble(
x = c(qnorm(1 - p), tail_high),
y = c(0, dnorm(tail_high)))
tibble(x = c(-4, 4)) %>%
ggplot(aes(x)) +
stat_function(fun = dnorm) +
geom_polygon(data = df_tl, aes(x, y), fill = "#99CCFF") +
geom_polygon(data = df_th, aes(x, y), fill = "#99CCFF") +
geom_vline(xintercept = qnorm(p), lty = "dashed", lwd = 0.3) +
geom_vline(xintercept = qnorm(1-p), lty = "dashed", lwd = 0.3) +
annotate(geom = "text", -1.97, 0.1, label = "-1.96", hjust = "right") +
annotate(geom = "text", 1.97, 0.1, label = "1.96", hjust = "left") +
theme_classic() +
labs(
x="",
y="")
}
ci_plot()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggfortify)
library(ggthemes)
library(gridExtra)
# Prep the distribution data
x <- seq(-3, 3, 0.005)
y <- dnorm(x)
normal <- as.data.frame(cbind(x,y))
# pnorm plot 1
# pnorm(0)
x2 <- c(x[1:600], rep(0,601))
y2 <- c(y[1:600], rep(0,601))
p <- ggplot(mapping = aes(x, y), data = normal) +
geom_line(size = 1.3) +
geom_vline(xintercept = 0, color = "blue", size = 1.3, linetype = 2) +
scale_x_continuous(n.breaks = 7) +
labs(title = "pnorm(0)", x = NULL, y = NULL,
subtitle = "P is for Probability") +
geom_area(inherit.aes = F, mapping = aes(x=x2, y=y2), fill = "tomato",
alpha = 0.2) +
annotate(geom = "rect", xmin = -2.6, xmax = -2, ymin = 0.12, ymax = 0.18,
alpha = 1, fill = "white", color = "black") +
annotate(geom = "text", label = "0.50", x = -2.3, y = 0.15, size = 6) +
annotate(geom = "segment", x = -2.7, xend = 0, y = 0.01, yend = 0.01,
size = 1.1, arrow = arrow(length = unit(3, "mm"))) +
theme_classic(base_size = 14, base_family = "Courier") +
theme(plot.title = element_text(size = 24, face = "bold", hjust = 0.5)) +
theme(plot.subtitle = element_text(face = "italic", hjust = 0.5))
p
library(tidyverse)
library(broom)
library(stringr)
library(forcats)
options(scipen = 999)
birthday <- function(k) {
logdenom <- k * log(365) + lfactorial(365 - k)
lognumer <- lfactorial(365)
pr <- 1 -   exp(lognumer - logdenom)
pr
}
bday <- tibble(k = 1:50, pr = birthday(k))
tibble(
k = 1:50,
pr = birthday(k)
) %>%
ggplot(aes(x = k, y = pr)) +
geom_hline(yintercept = 0.5, colour = "white", size = 2) +
geom_line() +
geom_point() +
scale_y_continuous(str_c("Probability that at least two",
"people have the same birthday", sep = "\n"),
limits = c(0, 1), breaks = seq(0, 1, by = 0.1)) +
labs(x = "Number of people")
ggplot(bday, aes(x = k, y = pr)) +
geom_hline(yintercept = 0.5, colour = "white", size = 2) +
geom_line() +
geom_point() +
scale_y_continuous(str_c("Probability that at least two",
"people have the same birthday", sep = "\n"),
limits = c(0, 1), breaks = seq(0, 1, by = 0.1)) +
labs(x = "Number of people")
sim_bdays <- function(k) {
days <- sample(1:365, k, replace = TRUE)
length(unique(days)) < k
}
#k = 10
sim_bdays(10)

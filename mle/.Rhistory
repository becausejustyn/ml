) +
theme_bw(base_size = 16)
llh_poisson <- function(lambda, y){
# log(likelihood) by summing
llh <- sum(dpois(y, lambda, log=TRUE))
return(llh)
}
lambdas <- seq(1, 100, by = 1)
ll <- sapply(lambdas, function(x){llh_poisson(x, data)})
llh_poisson
#llh_single
ll <- sapply(lambdas, function(x){llh_poisson(x, llh_single)})
ll <- sapply(lambdas, function(x){llh_poisson(x, pois_data)})
ll2 <- map(lambdas, llh_poisson(pois_data))
map(llh_poisson(lambdas, pois_data))
df <- data.frame(
ll = ll,
lambda = lambdas)
qplot(lambda_vals, log_likelihood, data = pois_mle)
df %>%
ggplot(aes(
x = lambda,
y = ll
))+
geom_point(size = 4, colour = "dodgerblue") +
labs(
x = "Lambda",
y = "Log Likelihood"
) +
theme_bw(base_size = 16) +
geom_vline(xintercept = lambdas[which.max(ll)], color = "red", size = 2)
df %>%
ggplot(aes(
x = lambda,
y = ll
))+
geom_point(size = 2, colour = "dodgerblue") +
labs(
x = "Lambda",
y = "Log Likelihood"
) +
theme_bw(base_size = 16) +
geom_vline(xintercept = lambdas[which.max(ll)], color = "red", size = 2)
df %>%
ggplot(aes(
x = lambda,
y = ll
))+
geom_point(size = 1.5, colour = "dodgerblue") +
labs(
x = "Lambda",
y = "Log Likelihood"
) +
theme_bw(base_size = 16) +
geom_vline(xintercept = lambdas[which.max(ll)], color = "red", size = 2)
df %>%
ggplot(aes(
x = lambda,
y = ll
))+
geom_point(size = 1.5, colour = "dodgerblue") +
labs(
x = "Lambda",
y = "Log Likelihood"
) +
theme_bw(base_size = 16) +
geom_vline(xintercept = lambdas[which.max(ll)], color = "red", size = 1.5)
library(stats4)
data <- rpois(n = 100, lambda = 5)
lambdas <- seq(1, 15, by = 0.5)
# function to compute log likelihood
# for Poisson distribution
llh_poisson <- function(lambda, y){
# log(likelihood) by summing
llh <- sum(dpois(y, lambda, log = TRUE))
return(llh)
}
nLL <- function(lambda) sum(stats::dpois(y, lambda, log = TRUE))
fit0 <- mle(nLL, start = list(lambda = 1), nobs = NROW(y))
data
fit0 <- mle(nLL, start = list(lambda = 1), nobs = NROW(data))
styler:::style_selection()
set.seed(2017)
p.parameter <- 0.8
sequence <- rbinom(10, 1, p.parameter)
likelihood <- function(sequence, p.parameter) {
likelihood <- 1
for (i in 1:length(sequence)) {
if (sequence[i] == 1) {
likelihood <- likelihood * p.parameter
} else {
likelihood <- likelihood * (1 - p.parameter)
}
}
return(likelihood)
}
styler:::style_selection()
possible.p <- seq(0, 1, by = 0.001)
qplot(
possible.p,
map_dbl(possible.p, function(p) {
likelihood(sequence, p)
}),
geom = "line",
main = "Likelihood as a Function of P",
xlab = "P",
ylab = "Likelihood"
)
mle.results <- optimize(
function(p) {likelihood(sequence, p)},
interval = c(0, 1), #values of p must lie in the interval
maximum = TRUE
)
mle.results
styler:::style_selection()
styler:::style_active_file()
log.likelihood <- function(sequence, p) {
log.likelihood <- 0
for (i in 1:length(sequence)) {
if (sequence[i] == 1) {
log.likelihood <- log.likelihood + log(p)
} else {
log.likelihood <- log.likelihood + log(1 - p)
}
}
return(log.likelihood)
}
log.likelihood2 <- function(sequence, p) {
log.likelihood <- 0
for (i in 1:length(sequence)) {
if (sequence[i] == 1) {
log.likelihood <- log.likelihood + log(p)
} else {
log.likelihood <- log.likelihood + log(1 - p)
}
}
return(log.likelihood)
}
sequence <- c(0, 1, 1, 1, 1, 1, 1, 0, 1, 0)
possible.p <- seq(0, 1, by = 0.001)
qplot(
possible.p,
sapply(possible.p, function(p) {
log.likelihood(sequence, p)
}),
geom = "line",
main = "Log Likelihood as a Function of P",
xlab = "P",
ylab = "Log Likelihood"
)
mle.results_log <- optimize(
function(p) {
likelihood(sequence, p)
},
interval = c(0, 1), # values of p must lie in the interval
maximum = TRUE
)
mle.results_log
lprob_poisson <- function(lambda, x) {
n <- length(x)
(log(lambda) * sum(x)) - (n * lambda) - sum(lfactorial(x))
}
ll_poisson1 <- function(x) {
n <- length(x)
function(lambda) {
log(lambda) * sum(x) - n * lambda - sum(lfactorial(x))
}
}
x1 <- c(41, 30, 31, 38, 29, 24, 30, 29, 31, 38)
lprob_poisson(c(10, 20, 30), x1)
ll1 <- ll_poisson1(x1)
optimise(ll1, c(0, 100), maximum = TRUE)
optimise(lprob_poisson, c(0, 100), x = x1, maximum = TRUE)
pois_10 <- data.frame(lambda_vals = 0:20) %>%
mutate(likelihood = dpois(x = 10, lambda = lambda_vals))
pois_10 %>%
filter(likelihood == max(likelihood))
ggplot(pois_10, aes(x = lambda_vals, y = likelihood)) +
geom_point()
# geom_line()
ggplot(pois_10, aes(x = lambda_vals, y = likelihood)) +
geom_point()
geom_line()
ggplot(pois_10, aes(x = lambda_vals, y = likelihood)) +
geom_point()
geom_line(max(likelihood))
ggplot(pois_10, aes(x = lambda_vals, y = likelihood)) +
geom_point()
geom_line(aes(x = max(likelihood)))
ggplot(pois_10, aes(x = lambda_vals, y = likelihood)) +
geom_point() +
geom_line(aes(x = max(likelihood)))
ggplot(pois_10, aes(x = lambda_vals, y = likelihood)) +
geom_point() +
geom_line()
set.seed(2017)
pois_10_log <- pois_10 %>%
mutate(log_likelihood = dpois(x = 10, lambda = lambda_vals, log = TRUE))
ggplot(pois_10_log, aes(x = lambda_vals, y = log_likelihood)) +
geom_point()
set.seed(2017)
crossing(
mu = seq(from = 10, to = 30, by = 0.1),
sigma = seq(from = 0, to = 10, by = 0.1)
) %>%
rowwise() %>%
mutate(
L = prod(dnorm(c(30, 20, 24, 27), mean = mu, sd = sigma))
) %>%
arrange(desc(L))
library(tidyverse)
options(scipen = 999, digits = 2)
pois_likelihood <- function(y, lambda){
# Data Generating Process
y_hat <- lambda
#likelihood function
sum(dpois(y, lambda = y_hat, log = TRUE))
#sum makes the function scalable
}
set.seed(2017)
pois_data <- rpois(10, lambda = 10)
pois_mle <- data.frame(lambda_vals = 0:20) %>%
rowwise() %>%
mutate(log_likelihood = pois_likelihood(y = pois_data, lambda = lambda_vals)) %>%
ungroup()
#Plot the surface
qplot(lambda_vals, log_likelihood, data=pois_mle)
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_point()
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_line()
pois_mle %>%
filter(log_likelihood == max(log_likelihood))
pull(pois_mle, log_likelihood) %>% max()
filter(pois_mle, log_likelihood == log_likelihood) %>% max()
filter(pois_mle, log_likelihood == log_likelihood)
pois_mle %>%
filter(log_likelihood == max(log_likelihood))
filter(pois_mle, log_likelihood == log_likelihood %>% max())
# compute log-likelihood of single data point
log_likelihood <- dpois(pois_data[1], lambda = seq(20), log = TRUE)
# log likelihood in data frame
llh_single <- data.frame(x = seq(20), log_like = log_likelihood)
llh_single %>%
ggplot(aes(
x = x,
y = log_like
)) +
geom_point(size = 4, coloUr = "dodgerblue") +
labs(
x = "Lambda",
y = "Log Likelihood",
title = "Log-Likelihood of a single data point"
) +
theme_bw(base_size = 16)
llh_poisson <- function(lambda, y){
# log(likelihood) by summing
llh <- sum(dpois(y, lambda, log=TRUE))
return(llh)
}
lambdas <- seq(1, 100, by = 1)
# compute log-likelihood for all lambda values
ll <- sapply(lambdas, function(x){llh_poisson(x, pois_data)})
df <- data.frame(
ll = ll,
lambda = lambdas)
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) + geom_point()
df %>%
ggplot(aes(
x = lambda,
y = ll
))+
geom_point(size = 1.5, colour = "dodgerblue") +
labs(
x = "Lambda",
y = "Log Likelihood"
) +
theme_bw(base_size = 16) +
geom_vline(xintercept = lambdas[which.max(ll)], color = "red", size = 1.5)
library(stats4)
data <- rpois(n = 100, lambda = 5)
lambdas <- seq(1, 15, by = 0.5)
# function to compute log likelihood
# for Poisson distribution
llh_poisson <- function(lambda, y){
# log(likelihood) by summing
llh <- sum(dpois(y, lambda, log = TRUE))
return(llh)
}
nLL <- function(lambda) sum(stats::dpois(y, lambda, log = TRUE))
fit0 <- mle(nLL, start = list(lambda = 1), nobs = NROW(y))
nLL
?dpois
data
lambdas
?mle
# set seed for random numbers
set.seed(42)
# simulate data from Normal distribution
x <- rnorm(200, mean=2, sd=2)
data.frame(x=x) %>%
ggplot(aes(x=x))+
geom_histogram(bins=30, color="blue",fill="dodgerblue") +
theme_bw(base_size = 16) +
xlab("Data")
# likelihood function for normal distribution
# with two unknowns
neg_log_lik_gaussian <- function(mu,sigma) {
-sum(dnorm(x, mean=mu, sd=sigma, log=TRUE))
}
gaussian_fit <- mle(neg_log_lik_gaussian,
start=list(mu=1, sigma=1),
method="L-BFGS-B")
summary(gaussian_fit)
set.seed(2017)
p.parameter <- 0.8
sequence <- rbinom(10, 1, p.parameter)
likelihood <- function(sequence, p.parameter) {
likelihood <- 1
for (i in 1:length(sequence)) {
if (sequence[i] == 1) {
likelihood <- likelihood * p.parameter
} else {
likelihood <- likelihood * (1 - p.parameter)
}
}
return(likelihood)
}
possible.p <- seq(0, 1, by = 0.001)
qplot(
possible.p,
map_dbl(possible.p, function(p) {
likelihood(sequence, p)
}),
geom = "line",
main = "Likelihood as a Function of P",
xlab = "P",
ylab = "Likelihood"
)
mle.results <- optimize(
function(p) {
likelihood(sequence, p)
},
interval = c(0, 1), # values of p must lie in the interval
maximum = TRUE
)
mle.results
pois_likelihood <- function(y, lambda){
# Data Generating Process
y_hat <- lambda
#likelihood function
sum(dpois(y, lambda = y_hat, log = TRUE))
#sum makes the function scalable
}
library(tidyverse)
options(scipen = 999, digits = 2)
pois_likelihood <- function(y, lambda){
y_hat <- lambda
#likelihood function
sum(dpois(y, lambda = y_hat, log = TRUE))
#sum makes the function scalable
}
set.seed(2017)
pois_data <- rpois(10, lambda = 10)
pois_mle <- data.frame(lambda_vals = 0:20) %>%
rowwise() %>%
mutate(log_likelihood = pois_likelihood(y = pois_data, lambda = lambda_vals)) %>%
ungroup()
#Plot the surface
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_point()
seq(1, 20, 0.1)
set.seed(2017)
pois_data <- rpois(10, lambda = 10)
pois_mle <- data.frame(lambda_vals = seq(1, 20, 0.1)) %>%
rowwise() %>%
mutate(log_likelihood = pois_likelihood(y = pois_data, lambda = lambda_vals)) %>%
ungroup()
#Plot the surface
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_point()
seq(1, 20, 0.5)
set.seed(2017)
pois_data <- rpois(10, lambda = 10)
pois_mle <- data.frame(lambda_vals = seq(1, 20, 0.5)) %>%
rowwise() %>%
mutate(log_likelihood = pois_likelihood(y = pois_data, lambda = lambda_vals)) %>%
ungroup()
#Plot the surface
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_point()
seq(1, 20, length.out = 50)
set.seed(2017)
pois_data <- rpois(10, lambda = 10)
pois_mle <- data.frame(lambda_vals = seq(1, 20, length.out = 50)) %>%
rowwise() %>%
mutate(log_likelihood = pois_likelihood(y = pois_data, lambda = lambda_vals)) %>%
ungroup()
#Plot the surface
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_point()
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_point() +
geom_line(data = filter(pois_mle, log_likelihood == log_likelihood %>% max()), aes(lambda_vals))
?geom_vline
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_point() +
geom_vline(data = filter(pois_mle, log_likelihood == log_likelihood %>% max()), aes(xintercept = lambda_vals))
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_point(colour = "#FFB06B") +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#1590AB")
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#1590AB", size = 2) +
geom_point(colour = "#FFB06B")
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#1590AB", size = 2) +
geom_point(colour = "#FFB06B", size = 1.25)
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#1590AB", size = 2) +
geom_point(colour = "#FFB06B", size = 1.5)
?geom_point
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#1590AB", size = 2) +
geom_point(colour = "#FFB06B", size = 2)
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#1590AB", size = 1.5) +
geom_point(colour = "#FFB06B", size = 2)
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#1590AB", size = 1.5) +
geom_point(colour = "#FFB06B", size = 2) +
hrbrthemes::theme_ft_rc()
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#1590AB", size = 1.5) +
geom_point(colour = "#FFB06B", size = 2) +
hrbrthemes::theme_ft_rc() +
labs(
x = "Lambda",
y = "Log Likelihood"
)
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#117881", size = 1.5) +
geom_point(colour = "#FFB06B", size = 2) +
hrbrthemes::theme_ft_rc() +
labs(
x = "Lambda",
y = "Log Likelihood"
)
pois_mle
pull(pois_mle, log_likelihood) %>% range()
seq(-190, -20, 10)
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#117881", size = 1.5) +
geom_point(colour = "#FFB06B", size = 2) +
hrbrthemes::theme_ft_rc() +
scale_x_continuous(breaks = seq(1, 20, 1)) +
scale_y_continuous(breaks = seq(-190, -20, 10)) +
labs(
x = "Lambda",
y = "Log Likelihood"
)
pois_mle %>%
ggplot(aes(x = lambda_vals, y = log_likelihood)) +
geom_vline(
data = filter(pois_mle, log_likelihood == log_likelihood %>% max()),
aes(xintercept = lambda_vals), colour = "#117881", size = 1.5) +
geom_point(colour = "#FFB06B", size = 2) +
hrbrthemes::theme_ft_rc() +
scale_x_continuous(breaks = seq(1, 20, 2)) +
scale_y_continuous(breaks = seq(-190, -20, 20)) +
labs(
x = "Lambda",
y = "Log Likelihood"
)
